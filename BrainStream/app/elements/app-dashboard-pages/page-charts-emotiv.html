<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="emotiv-chart.html">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.6/Chart.min.js"></script>
<dom-module id="page-charts-emotiv">
  <template>
    <style include="shared-styles"></style>
    <style>
      :host::shadow .widget {
        height: auto !important;
      / / todo: remove important min-height: 460 px;
      }

      #cenas {
        height: 50px;
        width: 1000px;

      }

      #updating-chart {
        width: 100%;
        height: 100%;
      }
    </style>
    <!--  <chart-line id="chart" data="[[data]]" options="[[options]]"></chart-line>-->

    <div id="cenas">
      <canvas id="updating-chart"></canvas>
    </div>

  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        is: 'page-charts-emotiv',

        properties: {
          cols: {
            type: Object,
            notify: true
          },
          myChart: {
            type: Object,
            notify: true
          },
          data: {
            type: Object,
            notify: true
          },
          AF3Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          AF3Temp: {
            type: Array,
            notify: true
          },
          AF4Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          AF4Temp: {
            type: Array,
            notify: true
          },
          F3Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          F3Temp: {
            type: Array,
            notify: true
          },
          F4Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          F4Temp: {
            type: Array,
            notify: true
          },
          F7Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          F7Temp: {
            type: Array,
            notify: true
          },
          F8Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          F8Temp: {
            type: Array,
            notify: true
          },
          FC5Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          FC5Temp: {
            type: Array,
            notify: true
          },
          FC6Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          FC6Temp: {
            type: Array,
            notify: true
          },
          O1Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          O1Temp: {
            type: Array,
            notify: true
          },
          O2Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          O2Temp: {
            type: Array,
            notify: true
          },
          P7Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          P7Temp: {
            type: Array,
            notify: true
          },
          P8Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          P8Temp: {
            type: Array,
            notify: true
          },
          T7Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          T7Temp: {
            type: Array,
            notify: true
          },
          T8Checked: {
            type: Boolean,
            notify: true,
            value: true
          },
          T8Temp: {
            type: Array,
            notify: true
          }
        },
        setChartData: function (self, snapshot) {
          var data = snapshot.val();
          if (self.AF3Checked) {
            var values = data.AF3;
            if(values != undefined) {
              values = values.freqVals;
              self.myChart.data.datasets[0].data = values;
            }
          } else {
            //self.AF3Temp.push(data.LowGamma);
          }

           if (self.AF4Checked) {
             var values = data.AF4;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[1].data = values;
             }
           } else {
           //self.AF4Temp.push(data.MidGamma);
           }

           if (self.F3Checked) {
             var values = data.F3;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[2].data = values;
             }
           } else {
         //  self.F3Temp.push(data.LowBeta);
           }

           if (self.F4Checked) {
             var values = data.F4;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[3].data = values;
             }
           } else {
          // self.F4Temp.push(data.HighBeta);
           }

           if (self.F7Checked) {
             var values = data.F7;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[4].data = values;
             }
           } else {
         //  self.F7Temp.push(data.LowAlpha);
           }

           if (self.F8Checked) {
             var values = data.F8;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[5].data = values;
             }
           } else {
         //  self.F8Temp.push(data.HighAlpha);
           }

           if (self.FC5Checked) {
             var values = data.FC5;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[6].data = values;
             }
           } else {
       //    self.FC5Temp.push(data.Theta);
           }

           if (self.FC6Checked) {
             var values = data.FC6;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[7].data = values;
             }
           } else {
         //  self.FC6Temp.push(data.Delta);
           }
           if (self.O1Checked) {
             var values = data.O1;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[8].data = values;
             }
           } else {
        //   self.O1Temp.push(data.Delta);
           }
           if (self.O2Checked) {
             var values = data.O2;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[9].data = values;
             }
           } else {
       //    self.O2Temp.push(data.Delta);
           }
           if (self.P7Checked) {
             var values = data.P7;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[10].data = values;
             }
           } else {
       //    self.P7Temp.push(data.Delta);
           }
           if (self.P8Checked) {
             var values = data.P8;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[11].data = values;
             }
           } else {
       //    self.P8Temp.push(data.Delta);
           }

           if (self.T7Checked) {
             var values = data.T7;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[12].data = values;
             }
           } else {
        //   self.T7Temp.push(data.Delta);
           }
           if (self.T8Checked) {
             var values = data.T8;
             if(values != undefined) {
               values = values.freqVals;
               self.myChart.data.datasets[13].data = values;
             }
           } else {
        //   self.T8Temp.push(data.Delta);
           }

          self.myChart.update();
        }
        ,
        buildChartData: function () {
          this.data = {
            labels: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30],
            datasets: [
              {
                label: "AF3",
                fillColor: "rgba(0,0,0,0)",
                borderColor: "#fcea0f",
                backgroundColor: "#fcea0f",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "AF4",
                fillColor: "rgba(0,0,0,0)",
                borderColor: "#f39200",
                backgroundColor: "#f39200",
                strokeColor: "#f39200",
                pointColor: "#f39200",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "F3",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#00a09a",
                borderColor: "#00a09a",
                backgroundColor: "#00a09a",
                pointColor: "#00a09a",
                pointStrokeColor: "#00a09a",
                pointHighlightFill: "#00a09a",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "F4",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "F7",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "F8",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "FC5",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "FC6",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "O1",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "O2",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "P7",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "P8",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "T7",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              },
              {
                label: "T8",
                fillColor: "rgba(0,0,0,0)",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
              }
            ]
          };


          return this.data;
        },
        setupChart: function() {
          var self = this;
          var myLabels = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30];
          var ctx = document.getElementById("updating-chart");
          this.myChart = null;
          this.myChart = new Chart(ctx, {
            type: 'line',
            data: {
              labels: myLabels,
              datasets: [{
                label: "AF3",
                fillColor: "rgba(0,0,0,0)",
                backgroundColor: "#fcea0f",
                borderColor: "#fcea0f",
                strokeColor: "#fcea0f",
                pointColor: "#fcea0f",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(151,187,205,1)",
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                fill: false,
                lineTension: 0
              },
                {
                  label: "AF4",
                  backgroundColor: "#f39200",
                  borderColor: "#f39200",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#f39200",
                  pointColor: "#f39200",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "F3",
                  fillColor: "rgba(0,0,0,0)",
                  borderColor: "#00a09a",
                  backgroundColor: "#00a09a",
                  strokeColor: "#00a09a",
                  pointColor: "#00a09a",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "F4",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#2eac66",
                  borderColor: "#2eac66",
                  backgroundColor: "#2eac66",
                  pointColor: "#2eac66",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "F7",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#302683",
                  borderColor: "#302683",
                  backgroundColor: "#302683",
                  pointColor: "#302683",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "F8",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#1d70b7",
                  borderColor: "#1d70b7",
                  backgroundColor: "#1d70b7",
                  pointColor: "#1d70b7",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "FC5",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#45405e",
                  borderColor:  "#45405e",
                  backgroundColor:  "#45405e",
                  pointColor: "#45405e",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "FC6",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#9d9c9c",
                  pointColor: "#9d9c9c",
                  borderColor: "#9d9c9c",
                  backgroundColor: "#9d9c9c",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "O1",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#fcea0f",
                  borderColor: "#aaaa0f",
                  backgroundColor: "#aaaa0f",
                  pointColor: "#fcea0f",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "O2",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#fcea0f",
                  borderColor: "#a2344f",
                  backgroundColor: "#a2344f",
                  pointColor: "#fcea0f",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "P7",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#fcea0f",
                  borderColor: "#FF0000",
                  backgroundColor: "#FF0000",
                  pointColor: "#fcea0f",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "P8",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#fcea0f",
                  pointColor: "#fcea0f",
                  borderColor: "rgb(0,255,0)",
                  backgroundColor: "rgb(0,255,0)",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "T7",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#fcea0f",
                  pointColor: "#fcea0f",
                  borderColor: "#00ffff",
                  backgroundColor: "#00ffff",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                },
                {
                  label: "T8",
                  fillColor: "rgba(0,0,0,0)",
                  strokeColor: "#fcea0f",
                  pointColor: "#fcea0f",
                  pointStrokeColor: "#fff",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(151,187,205,1)",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                  fill: false,
                  lineTension: 0
                }
              ]
            },
            options: {
              animation: false,
              scales: {
                yAxes: [{
                  display: true,
                  ticks: {
                    min: -80,
                    max: 80,
                    stepSize: 10
                  }
                }]
              }
            }
          });
        },

        ready: function () {
          var self = this;
          var ref;
          var counter = 0;
          var lastState = false;
          var currentState = false;

          addEventListener('selected-hist-emotiv', function(vals) {
            counter = 0;
            lastState = currentState;
            currentState = vals.detail[0];
            if(self.myChart != undefined) {
              self.myChart.destroy();
            }
            self.setupChart();

            ref = new Firebase("https://brainlight.firebaseio.com/leituras/" + vals.detail[1]);
            ref.limitToLast(1).on("child_added", function (snapshot) {
              if (snapshot.val()) {
                if(currentState == false && lastState == true) {
                  // We only want to receive one copy when changing from true -> false
                  if(counter > 0) return;
                  self.setChartData(self, snapshot);
                  counter += 1;
                } else {
                  self.setChartData(self, snapshot);
                }
              }
            });
          });
        }
      });
    })();
  </script>
</dom-module>
